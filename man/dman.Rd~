\name{dmand}
\alias{dmand}
\alias{pmand}
\alias{qmand}
\title{Zipf-Mandelbrodt distribution}

\description{
Density, distribution function and quantile function for
Zipf-Mandelbrodt distribution with parameters ‘N’ 's' and ‘v’.
}
\usage{
dmand( x, N, s, v, log=FALSE)
pmand( q, N, s, v, lower.tail=TRUE, log.p=FALSE)
qmand( p, N, s, v, lower.tail = TRUE, log.p = FALSE)
}

\arguments{
  \item{x}{
    vector of (non-negative integer) quantiles. In the context of
    species abundance distributions, this is a vector of abundances or
    abundance ranks of species in a sample.
  }
  \item{q}{vector of (non-negative integer) quantiles. In the context of
    species abundance distributions, a vector of
    abundances or abundance ranks of species in a sample.
  }
  \item{p}{
    vetor of probabilities.
  }
  \item{N}{
    positive integer 0 < N < Inf, total number of elements of a collection. In the context of
    species abundance distributions, usually the number of species in a sample.
  }
  \item{s}{
    positive real s > 0; Zipf-Mandelbrodt exponent.
  }
  \item{v}{
    positive real v > 0; Zipf-Mandelbrodt parameter.  
    }
  \item{log, log.p}{
    logical; if TRUE, probabilities p are given as log(p).
  }
  \item{lower.tail}{
    logical; if TRUE (default), probabilities are P[X <= x],
    otherwise, P[X > x].
  }
}

\details{
  The Mandelbrodt distribution describes the probability or frequency of occurrence
  of a given element from a set of 'N' elements. This probability  is inversely proportional to a power 's' of the
  rank of the frequency of the element in the set. The density function is

  p(x) = ((x+v)^(-s)) / sum(((1:N)+q)^(-s))

  Since p(x) is proportional to a power of 'x', the Zipf-Mandelbrodt distribution is a
  power distribution. The Zipf distribution is a special case when v=0.

  The Zipf-Mandelbrodt distribution is widely used to describe the probability
  of occurrence of a given word that has a ranking 'x' in a \emph{corpus} that has a total of 'N'
  words. It can be used as well to describe the probability of the rank
  or abundance 'x' of given species in a sample or assemblage of 'N' species.
}

\value{
'dmand' gives the (log) density of the density, 'pmand' gives the (log)
distribution function, 'qmand' gives the quantile function.
}

\references{

  Johnson N. L., Kemp, A. W. and Kotz S. (2005) Univariate Discrete
  Distributions, 3rd edition, Hoboken, New Jersey: Wiley. Section 11.2.20. 
}

\author{
Paulo I. Prado and Murilo Dantas Miranda
}

\seealso{
'dmand' and 'rmand' and related functions in mandR package; 'Zeta' for
zeta distribution in
VGAM package; 'fitmand' for maximum likelihood estimation in the context of species abundance distributions.
}

\examples{
x <- 1:20
pdf <- dmand(x=x, N=100, s=2)
cdf <- pmand(q=x, N=100, s=2)
par(mfrow=c(1,2))
plot(x,cdf, ylab="Cumulative Probability", type="b",
     main="Mand distribution, CDF")
plot(x,pdf, ylab="Probability", type="h",
     main="Mand distribution, PDF")
par(mfrow=c(1,1))

## quantile is the inverse of cdf
sum(qmand(cdf,N=100, s=2)-x) # should be zero
}